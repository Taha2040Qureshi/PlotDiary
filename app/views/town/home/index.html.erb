<section id="content">
  <section class="vbox">
    <section class="scrollable padder">

      <div class="m-b-md">
        <h3 class="m-b-none"><%=@town.name if @town.present?%></h3>
        <small>Welcome back, <%=current_user.email%></small>
      </div>
      <section class="panel panel-default">
        <div class="row m-l-none m-r-none bg-light lter">
          <div class="col-sm-6 col-md-3 padder-v b-r b-light">
                    <span class="fa-stack fa-2x pull-left m-r-sm">
                      <i class="fa fa-circle fa-stack-2x text-info"></i>
                      <i class="fa fa-users fa-stack-1x text-white"></i>
                    </span>
            <a class="clear" href="#">
              <span class="h3 block m-t-xs"><strong><%=@town.customers.count if @town.present?%></strong></span>
              <small class="text-muted text-uc">Total Customers</small>
            </a>
          </div>
          <div class="col-sm-6 col-md-3 padder-v b-r b-light lt">
                    <span class="fa-stack fa-2x pull-left m-r-sm">
                      <i class="fa fa-circle fa-stack-2x text-warning"></i>
                      <i class="fa fa-building-o fa-stack-1x text-white"></i>
                      <span class="easypiechart pos-abt" data-percent="100" data-line-width="4" data-track-Color="#fff" data-scale-Color="false" data-size="50" data-line-cap='butt' data-animate="2000" data-target="#bugs" data-update="3000"></span>
                    </span>
            <a class="clear" href="#">
              <span class="h3 block m-t-xs"><strong id="bugs"><%=@town.plots.count if @town.present?%></strong></span>
              <small class="text-muted text-uc">PLOTS</small>
            </a>
          </div>
          <div class="col-sm-6 col-md-3 padder-v b-r b-light">
                    <span class="fa-stack fa-2x pull-left m-r-sm">
                      <i class="fa fa-circle fa-stack-2x text-danger"></i>
                      <i class="fa fa-money fa-stack-1x text-white"></i>
                      <span class="easypiechart pos-abt" data-percent="100" data-line-width="4" data-track-Color="#f5f5f5" data-scale-Color="false" data-size="50" data-line-cap='butt' data-animate="3000" data-target="#firers" data-update="5000"></span>
                    </span>
            <a class="clear" href="#">
              <span class="h3 block m-t-xs"><strong id="firers"></strong></span>
              <small class="text-muted text-uc">Expense</small>
            </a>
          </div>
          <div class="col-sm-6 col-md-3 padder-v b-r b-light lt">
                    <span class="fa-stack fa-2x pull-left m-r-sm">
                      <i class="fa fa-bookmark fa-stack-2x icon-muted"></i>
                      <i class="fa fa-clock-o fa-stack-1x text-white"></i>
                    </span>
            <a class="clear" href="#">
              <span class="h3 block m-t-xs"><strong></strong></span>
              <small class="text-muted text-uc">Installment</small>
            </a>

          </div>
        </div>
      </section>





      <div class="panel panel-primary">
        <div class="page-header"><h3>General Calculation</h3></div>
        <div class="panel-body">
          <div class="form-group">
            <div id="error"></div>
            <label for="usr">Total Amount </label>
            <input type="number" name="totalAmount" class="form-control" id="totalAmount">
          </div>
          <div class="form-group">
            <label for="usr">Amount Paid</label>
            <input type="number" name="advanceAmount" class="form-control" id="advanceAmount">
          </div>
          <div class="form-group">
            <label for="usr">Remaining Amount</label>
            <input type="number" name="remainingAmount" class="form-control" id="remainingAmount">
          </div>
          <div class="form-group">
            <label for="usr">Number of installments</label>
            <input type="number" name="numberOfInstallments" class="form-control" id="numberOfInstallments">
          </div>
          <div class="form-group">
            <button type="button" class="btn btn-primary"  onclick="calculateInstallment();" id="btnCalculate">Calculate</button>
          </div>
          <div class="form-group">
            <label for="usr">Per installment Amount</label>
            <input type="number" name="PerInstallmentAmount" class="form-control" id="PerInstallmentAmount">
          </div>
        </div>
      </div>
      </div>

    </section>
  </section>
</section>




<script type="text/javascript">
  function calculateInstallment() {
      var totalAmount = parseInt($('#totalAmount').val());
      var advanceAmount = parseInt($('#advanceAmount').val());
      var remainingAmount = $('#remainingAmount').val();
      var numberOfInstallments = parseInt($('#numberOfInstallments').val());
      var perInstallmentAmount = $('#PerInstallmentAmountmount').val();

      if(advanceAmount >= totalAmount)
      {
          $('#error').append("Adance amount can't be greater then  OR  equal total amount ");
          return;
      }
      if(totalAmount == null)
      {
          $('#error').append("Total amount can't be empty ");
          return;
      }
      if(advanceAmount == null)
      {
          $('#error').append("Advance amount can't be empty ");
          return;
      }
      if( advanceAmount == totalAmount)
      {
          $('#error').append("Advance amount can't be equal to the Total amount ");
          return;
      }
      if(numberOfInstallments == null)
      {
          $('#error').append("Number of Installments can't be empty ");
          return;
      }
          var remainingAmount = totalAmount -advanceAmount;
          console.log(remainingAmount);
          $("#remainingAmount").val(remainingAmount);


      var perInstallmentAmount = remainingAmount / numberOfInstallments;
      console.log(perInstallmentAmount);
      $("#PerInstallmentAmount").val(perInstallmentAmount);

  }
</script>